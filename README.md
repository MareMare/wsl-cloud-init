# wsl-cloud-init
 ğŸ“WSL2 ä¸Šã® Ubuntu 24.04 LTS ã‚’è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ã€WSL2 ä¸Šã§ Ubuntu 24.04 LTS ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ãŸã‚ã® PowerShell ã‚¹ã‚¯ãƒªãƒ—ãƒˆ `setup-wsl-ubuntu2404-dev.ps1` ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€cloud-init ã‚’åˆ©ç”¨ã—ã¦é–‹ç™ºç’°å¢ƒã‚’è‡ªå‹•æ§‹ç¯‰ã—ã¾ã™ã€‚

## ç‰¹å¾´
- WSL2 ä¸Šã® Ubuntu 24.04 LTS ãƒ‡ã‚£ã‚¹ãƒˆãƒ­ã‚’è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- cloud-init ã«ã‚ˆã‚‹ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã‚’åˆ©ç”¨ã—ã¦ä»¥ä¸‹ã‚’è¨­å®š:
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¨­å®š
  - ãƒ­ã‚±ãƒ¼ãƒ«ã¨ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã®è¨­å®š
  - å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« (ä¾‹: `curl`, `git`, `docker.io` ãªã©)
  - Docker ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
  - Oh My Posh ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨è¨­å®š
  - WSL ã® systemd æœ‰åŠ¹åŒ–

## æ³¨æ„äº‹é …
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œå‰ã«ã€åŒã˜åå‰ã®ãƒ‡ã‚£ã‚¹ãƒˆãƒ­ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹å ´åˆã¯è‡ªå‹•çš„ã«ç™»éŒ²è§£é™¤ (`wsl --unregister`) ãŒè¡Œã‚ã‚Œã¾ã™ã€‚
- ç™»éŒ²è§£é™¤ã•ã‚Œã‚‹ãƒ‡ã‚£ã‚¹ãƒˆãƒ­ã®ãƒ‡ãƒ¼ã‚¿ã¯å‰Šé™¤ã•ã‚Œã‚‹ãŸã‚ã€å¿…è¦ã«å¿œã˜ã¦äº‹å‰ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã£ã¦ãã ã•ã„ã€‚

## å¿…è¦ãªç’°å¢ƒ
ä»¥ä¸‹ã¯ã€WSL ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’ç¢ºèªã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ä¾‹ã§ã™ã€‚

```ps1
PS> wsl --version
WSL ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 2.4.11.0
ã‚«ãƒ¼ãƒãƒ« ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 5.15.167.4-1
WSLg ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.0.65
MSRDC ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.2.5716
Direct3D ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 1.611.1-81528511
DXCore ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 10.0.26100.1-240331-1435.ge-release
Windows ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 10.0.26100.3194
```

## ä½¿ã„æ–¹

### 1. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
```ps1
.\setup-wsl-ubuntu2404-dev.ps1 -Password "YourPasswordHere"
```

### 2. åˆå›èµ·å‹•
ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œå¾Œã€è‡ªå‹•çš„ã«æŒ‡å®šã—ãŸãƒ‡ã‚£ã‚¹ãƒˆãƒ­åï¼ˆä¾‹: ubuntu2404-devï¼‰ã§ WSL ã®åˆå›èµ·å‹•ãŒè¡Œã‚ã‚Œã¾ã™ã€‚

### 3. cloud-init ã«ã‚ˆã‚‹ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã®ç¢ºèª
ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å¾Œã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ cloud-init ã®çŠ¶æ…‹ã‚’ç¢ºèªã§ãã¾ã™ã€‚
```bash
#!/bin/bash
whoami
sudo cloud-init status --wait --format json
sudo cloud-init query userdata
sudo cat /var/log/cloud-init-output.log
```

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‹•ä½œæ¦‚è¦
1. WSL ã®ãƒ‡ã‚£ã‚¹ãƒˆãƒ­åã¨ã—ã¦ ubuntu2404-dev ã‚’è¨­å®šã€‚
2. cloud-init ç”¨ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã€å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚„è¨­å®šã‚’è¨˜è¿°ã€‚
3. WSL ã« Ubuntu 24.04 ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚
   - æ—¢å­˜ã®ãƒ‡ã‚£ã‚¹ãƒˆãƒ­åãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ç™»éŒ²è§£é™¤ã‚’å®Ÿè¡Œã€‚
4. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†å¾Œã«åˆå›èµ·å‹•ã‚’å®Ÿè¡Œã€‚
5. cloud-init ã«ã‚ˆã‚‹ãƒ—ãƒ­ãƒ“ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã‚’å®Ÿè¡Œã€‚

## å‚è€ƒ
* [Using WSL with cloud\-init \- cloud\-init 25\.1 documentation](https://docs.cloud-init.io/en/latest/howto/launch_wsl.html#launch-wsl)
* [WSL \- cloud\-init 25\.1 documentation](https://docs.cloud-init.io/en/latest/reference/datasources/wsl.html#wsl-user-data-configuration)
